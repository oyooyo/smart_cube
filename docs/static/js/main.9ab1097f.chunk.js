(this.webpackJsonpsmart_cube=this.webpackJsonpsmart_cube||[]).push([[0],{27:function(t,e,n){},29:function(t,e,n){},31:function(t,e,n){"use strict";n.r(e);var r=n(5),a=n(12),i=n.n(a),c=n(20),o=n.n(c),s=(n(27),n(0)),u=n(2),l=n(3),f=n(4),h=n(9),d=(n(28),n(29),n(7)),b=n.n(d),v=n(10),p=n(19),j=n(13),m=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Assertion failed";if(!t)throw new Error(e)},_=function(t,e,n,r,a,i,c,o,s){m(e>=1&&e<=3,"Invalid angleFace"),s&&e<=2&&(e=1===e?2:1);var u=1===e?[o,i,c]:2===e?[c,o,i]:[i,c,o],l=Object(h.a)(u,3);t[n]=l[0],t[r]=l[1],t[a]=l[2]},w={1:[1,2,3],2:[1,3,4],3:[1,4,5],4:[1,5,2],5:[6,3,2],6:[6,4,3],7:[6,5,4],8:[6,2,5]},g=function(t,e,n,r,a,i,c){m(e>=1&&e<=8,"Invalid angle"),_.apply(void 0,[t,n,r,a,i].concat(Object(j.a)(w[e]),[c]))},O=function(t,e,n,r,a,i){m(e>=1&&e<=2,"Invalid lineFace");var c=1===e?[a,i]:[i,a],o=Object(h.a)(c,2);t[n]=o[0],t[r]=o[1]},x={1:[1,2],2:[1,3],3:[1,4],4:[1,5],5:[2,3],6:[4,3],7:[4,5],8:[2,5],9:[6,2],10:[6,3],11:[6,4],12:[6,5]},y=function(t,e,n,r,a){m(e>=1&&e<=12,"Invalid line"),O.apply(void 0,[t,n,r,a].concat(Object(j.a)(x[e])))},k=function(t,e,n,r,a){var i=[t[a],t[e],t[n],t[r]];t[e]=i[0],t[n]=i[1],t[r]=i[2],t[a]=i[3]},S=function(t,e,n){return Uint8Array.from({length:e},(function(e,r){return(r%2===0?M:D)(t[n+(r>>1)])}))},F=function(t){return Array.from(function(t){m(t.length>=16);for(var e=S(t,8,0),n=S(t,8,4),r=S(t,12,8),a=new Uint8Array(12),i=0;i<12;i++)a[i]=0!==(t[14+Math.floor(i/8)]&1<<7-i%8)?2:1;var c=new Uint8Array(55),o=[1,2,3,4,5,6];return c[32]=o[0],c[41]=o[1],c[50]=o[2],c[14]=o[3],c[23]=o[4],c[5]=o[5],g(c,e[0],n[0],34,43,54,!1),g(c,e[1],n[1],36,52,18,!0),g(c,e[2],n[2],30,16,27,!1),g(c,e[3],n[3],28,25,45,!0),g(c,e[4],n[4],1,48,37,!0),g(c,e[5],n[5],3,12,46,!1),g(c,e[6],n[6],9,21,10,!0),g(c,e[7],n[7],7,39,19,!1),y(c,r[0],a[0],31,44),y(c,r[1],a[1],35,53),y(c,r[2],a[2],33,17),y(c,r[3],a[3],29,26),y(c,r[4],a[4],40,51),y(c,r[5],a[5],15,49),y(c,r[6],a[6],13,24),y(c,r[7],a[7],42,22),y(c,r[8],a[8],4,38),y(c,r[9],a[9],2,47),y(c,r[10],a[10],6,11),y(c,r[11],a[11],8,20),k(c,1,7,9,3),k(c,4,8,6,2),k(c,37,19,10,46),k(c,38,20,11,47),k(c,39,21,12,48),k(c,40,22,13,49),k(c,41,23,14,50),k(c,42,24,15,51),k(c,43,25,16,52),k(c,44,26,17,53),k(c,45,27,18,54),k(c,34,28,30,36),k(c,31,29,33,35),c}(t)).slice(1)},M=function(t){return t>>4},D=function(t){return 15&t},U=new Uint8Array([80,175,152,32,170,119,19,137,218,230,63,95,46,130,106,175,163,243,20,7,167,21,168,232,143,175,42,125,126,57,254,87,217,91,85,215]),B=function(t){return m(20===t.length&&167===t[18],"Invalid encoded bytes array"),t.slice(0,18).map((function(e,n){return e-U[n+D(t[19])]-U[n+M(t[19])]}))},C=function(t,e){var n,r=Object(h.a)(e,2),a=r[0],i=r[1];return Array.from(Object(p.a)(Object(p.a)({},(n=a,Object.fromEntries(Object.entries(n).map((function(t){var e=Object(h.a)(t,2),n=e[0];return[e[1],n]}))))),{},{length:t.length}),(function(e){return i[t[e]]}))},L=[[36,37,38,39,40,41,42,43,44,15,12,9,16,13,10,17,14,11,53,52,51,50,49,48,47,46,45,26,25,24,23,22,21,20,19,18,29,32,35,28,31,34,27,30,33,0,1,2,3,4,5,6,7,8],{1:"F",2:"D",3:"R",4:"U",5:"L",6:"B"}],R=function(t){return C(t,L).join("")},A=[[0,1,2,3,4,5,6,7,8,36,37,38,39,40,41,42,43,44,18,19,20,21,22,23,24,25,26,9,10,11,12,13,14,15,16,17,45,46,47,48,49,50,51,52,53,27,28,29,30,31,32,33,34,35],{U:"U",L:"L",F:"F",R:"R",B:"B",D:"D"}],I=function(t){return C(Array.from(t),A).join("")},N=function(){var t=Object(v.a)(b.a.mark((function t(e){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!e){t.next=4;break}t.t0=e,t.next=7;break;case 4:return t.next=6,navigator.bluetooth.requestDevice({acceptAllDevices:!0,optionalServices:[43739]});case 6:t.t0=t.sent;case 7:return t.abrupt("return",t.t0);case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),E=function(){var t=Object(v.a)(b.a.mark((function t(e){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,N(e);case 2:return t.next=4,t.sent.gatt.connect();case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),P=function(){var t=Object(v.a)(b.a.mark((function t(e){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,E(e);case 2:return t.next=4,t.sent.getPrimaryService(43739);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),z=function(){var t=Object(v.a)(b.a.mark((function t(e){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,P(e);case 2:return t.next=4,t.sent.getCharacteristic(43740);case 4:return t.abrupt("return",t.sent);case 5:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),T=function(){var t=Object(v.a)(b.a.mark((function t(e,n){var r;return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,z(n);case 2:return r=t.sent,t.next=5,r.startNotifications();case 5:r.addEventListener("characteristicvaluechanged",(function(t){e(t.target.value)}));case 6:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),W=function(t){return new Uint8Array(t.buffer)},q=function(){var t=Object(v.a)(b.a.mark((function t(e,n){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,T((function(t){e(W(t))}),n);case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),H=function(){var t=Object(v.a)(b.a.mark((function t(e,n){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,q((function(t){e(B(t))}),n);case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),J=function(){var t=Object(v.a)(b.a.mark((function t(e,n){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,H((function(t){e(F(t))}),n);case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),Z=function(){var t=Object(v.a)(b.a.mark((function t(e,n){return b.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,J((function(t){e(R(t))}),n);case 2:case"end":return t.stop()}}),t)})));return function(e,n){return t.apply(this,arguments)}}(),G=n(17),K=n(1),Q=n(21),V=Math.PI,X=V/2,Y={U:[[0,0,1],[X,0,0]],"U'":[[0,0,1],[-X,0,0]],U2:[[0,0,1],[X,0,0]],L:[[-1,0,0],[0,0,X]],"L'":[[-1,0,0],[0,0,-X]],L2:[[-1,0,0],[0,0,X]],F:[[0,-1,0],[0,0,V]],"F'":[[0,-1,0],[0,0,0]],F2:[[0,-1,0],[0,0,V]],R:[[1,0,0],[0,0,-X]],"R'":[[1,0,0],[0,0,+X]],R2:[[1,0,0],[0,0,-X]],B:[[0,1,0],[0,0,0]],"B'":[[0,1,0],[0,0,V]],B2:[[0,1,0],[0,0,0]],D:[[0,0,-1],[-X,0,0]],"D'":[[0,0,-1],[X,0,0]],D2:[[0,0,-1],[-X,0,0]],S:[[0,0,0],[0,0,V]],"S'":[[0,0,0],[0,0,0]],S2:[[0,0,0],[0,0,V]],E:[[0,0,0],[-X,0,0]],"E'":[[0,0,0],[X,0,0]],E2:[[0,0,0],[-X,0,0]],M:[[0,0,0],[0,0,X]],"M'":[[0,0,0],[0,0,-X]],M2:[[0,0,0],[0,0,X]]},$=[[[-1,1,1.5],[1,0,0],[0,-1,0],16777215],[[-1.5,1,1],[0,-1,0],[0,0,-1],16744448],[[-1,-1.5,1],[1,0,0],[0,0,-1],65280],[[1.5,-1,1],[0,1,0],[0,0,-1],16711680],[[1,1.5,1],[-1,0,0],[0,0,-1],255],[[-1,-1,-1.5],[1,0,0],[0,1,0],16776960]],tt={U:0,L:1,F:2,R:3,B:4,D:5},et=function(t){return $[tt[t]][3]},nt=function(t,e){return Math.floor(t/e)},rt=function(t,e){return[nt(t,e),t%e]},at=function(t,e){return[t[0]+e[0],t[1]+e[1],t[2]+e[2]]},it=function(t,e){return[t[0]*e,t[1]*e,t[2]*e]},ct=function(t){return Math.abs(t)>1?.00390625:.875},ot=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:8421504,a=new K.a(ct(t),ct(e),ct(n)),i=new K.h({color:r}),c=new K.g(a,i);return c.position.set(t,e,n),c},st=function(t){var e=new K.c(.25,1,16);e.rotateZ(X),e.translate(0,0,2.5);var n=new K.g(e,new K.h({color:16777215,opacity:.75,transparent:!0}));return n.rotation.set(0,-t,0),n},ut=function(t){Object(l.a)(n,t);var e=Object(f.a)(n);function n(t){var r;return Object(s.a)(this,n),(r=e.call(this,t)).stickers=function(){for(var t=[],e=0;e<54;e++){var n=rt(e,9),r=Object(h.a)(n,2),a=r[0],i=r[1],c=rt(i,3),o=Object(h.a)(c,2),s=o[0],u=o[1],l=Object(h.a)($[a],4),f=l[0],d=l[1],b=l[2],v=l[3],p=at(at(f,it(b,s)),it(d,u)),m=ot.apply(void 0,Object(j.a)(p).concat([v]));t.push(m)}return t}(),r.arrows_object=function(){for(var t=new K.e,e=0;e<8;e++)t.add(st(V*e/4));return t}(),r.rotation_object=new K.e,r.rotation_object.add(r.arrows_object),r.rotation_object.add(new K.g(new K.a(3.01,1.01,3.01),new K.h({color:16777215,opacity:.75,transparent:!0}))),r.frame_index=0,r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var t=this,e=this.mount,n=e.clientWidth,r=e.clientHeight,a=new K.k,i=new K.i(60,n/r,.1,100);i.up.set(0,0,1),i.position.set(4,-5,4);var c=new K.p;c.setSize(n,r);var o=c.domElement;e.appendChild(o);var s=new Q.a(i,o);a.background=new K.b(4219008),a.add(new K.g(new K.a(3,3,3),new K.h({color:2105376})));var u,l=Object(G.a)(this.stickers);try{for(l.s();!(u=l.n()).done;){var f=u.value;a.add(f)}}catch(h){l.e(h)}finally{l.f()}a.add(this.rotation_object);!function o(){requestAnimationFrame(o);var u=e.clientWidth,l=e.clientHeight;u===n&&l===r||(i.aspect=u/l,i.updateProjectionMatrix(),c.setSize(u,l),n=u,r=l),s.update(),t.arrows_object.rotation.set(0,-t.frame_index*V/120%V,0),c.render(a,i),t.frame_index++}()}},{key:"render",value:function(){for(var t=this,e=0;e<54;e++){var n=this.props.state[e];this.stickers[e].material.color.setHex(et(n))}if(this.props.rotation){var a,i;this.rotation_object.visible=!0;var c=Object(h.a)(Y[this.props.rotation],2),o=c[0],s=c[1];(a=this.rotation_object.position).set.apply(a,Object(j.a)(o)),(i=this.rotation_object.rotation).set.apply(i,Object(j.a)(s))}else this.rotation_object.visible=!1;return Object(r.jsx)("div",{className:"cube_display",ref:function(e){t.mount=e}})}}]),n}(i.a.Component),lt=window.Cube,ft=function(t){var e=t.children;return Object(r.jsxs)("div",{className:"text-center",children:[Object(r.jsx)("div",{className:"spinner-border",role:"status",children:Object(r.jsx)("span",{className:"visually-hidden",children:"Please wait..."})}),Object(r.jsx)("div",{className:"mt-3",children:e})]})},ht=function(t,e,n){if(n>0){var r=Math.floor(Math.log10(n-1))+1;return"".concat(Array(r).fill("0").join("")).concat(Math.floor(t/e)%n).slice(-r)}return"".concat(Math.floor(t/e))},dt=function(t){return"".concat(ht(t,1e3),".").concat(ht(t,10,100)," seconds (").concat(ht(t,6e4),":").concat(ht(t,1e3,60),".").concat(ht(t,10,100)," minutes)")},bt=function(t){var e,n,i=t.cube_state,c=Object(a.useState)({id:"inactive"}),o=Object(h.a)(c,2),s=o[0],u=o[1],l=Date.now();switch(s.id){case"inactive":e=function(){u({id:"waiting_for_first_move",start_cube_state:i})},n="Click here to measure Time";break;case"waiting_for_first_move":i!==s.start_cube_state&&u({id:"waiting_for_solved",start_cube_state:s.start_cube_state,start_time:l,moves:0,last_cube_state:i}),e=function(){u({id:"inactive"})},n="Waiting for first move...";break;case"waiting_for_solved":i!==s.last_cube_state&&u("UUUUUUUUULLLLLLLLLFFFFFFFFFRRRRRRRRRBBBBBBBBBDDDDDDDDD"===i?{id:"solved",start_cube_state:i,start_time:s.start_time,finish_time:l,moves:s.moves+1}:{id:"waiting_for_solved",start_cube_state:s.start_cube_state,start_time:s.start_time,moves:s.moves+1,last_cube_state:i}),e=function(){u({id:"waiting_for_first_move",start_cube_state:i})},n="Current time: ".concat(dt(l-s.start_time),", ").concat(s.moves," moves");break;case"solved":e=function(){u({id:"waiting_for_first_move",start_cube_state:i})},n="Solved in: ".concat(dt(s.finish_time-s.start_time),", ").concat(s.moves," moves");break;default:throw new Error("Invalid state")}return Object(r.jsx)("div",{id:"measure_time_button",className:"d-grid mx-auto mt-3",children:Object(r.jsx)("button",{className:"btn btn-primary",type:"button",onClick:e,children:n})})},vt=function(t){Object(l.a)(n,t);var e=Object(f.a)(n);function n(t){var r;return Object(s.a)(this,n),(r=e.call(this,t)).state={id:"initializing_solver",facelets:null,rotations:null},r}return Object(u.a)(n,[{key:"componentDidMount",value:function(){var t=this;lt.asyncInit("".concat(window.location.href,"/cubejs/worker.js"),(function(){t.setState({id:"waiting_for_user_gesture"})}))}},{key:"on_cube_state_change",value:function(t){var e=this,n=this.state.facelets;this.setState({facelets:t});var r=lt.fromString(I(t));if(r.isSolved())this.setState({id:"solved",rotations:[]});else{if(this.state.rotations&&this.state.rotations.length>0){var a=lt.fromString(I(n));if(a.move(this.state.rotations[0]),r.asString()===a.asString())return void this.setState({id:"displaying_next_rotation",rotations:this.state.rotations.slice(1)})}this.setState({id:"solving",rotations:null}),r.asyncSolve((function(t){for(var n=0,r=["U","L","F","R","B","D","S","E","M"];n<r.length;n++){var a=r[n];t=t.replaceAll("".concat(a,"2"),"".concat(a," ").concat(a))}e.setState({id:"displaying_next_rotation",rotations:t.trim().split(" ")})}))}}},{key:"render",value:function(){var t=this;switch(this.state.id){case"initializing_solver":return Object(r.jsx)(ft,{children:"Initializing Rubik's Cube Solver..."});case"waiting_for_user_gesture":return"bluetooth"in navigator?Object(r.jsxs)("div",{children:[Object(r.jsxs)("div",{children:[Object(r.jsx)("p",{children:"Rotate the Mi Smart Magic Cube (to ensure it is turned on), then click the button below to connect to it. A new dialogue will open, showing all Bluetooth LE devices in range, and asking you to select the device."}),Object(r.jsx)("div",{className:"alert alert-warning",role:"alert",children:'Unfortunately, it can be hard to indentify which one of the shown devices the Mi Smart Magic Cube is. The device may show up as "Mi Smart Magic Cube", in which case choosing is simple. If there is no device with that name, it will be one of the devices that are shown without a name. If there are multiple, the signal strength indicator may help - place the cube next to your device, and the signal strength should be very high.'})]}),Object(r.jsx)("div",{className:"d-grid mt-3",children:Object(r.jsx)("button",{className:"btn btn-primary",type:"button",onClick:function(){t.setState({id:"connecting"}),Z((function(e){t.on_cube_state_change(e)}))},children:"Connect to Mi Smart Magic Cube"})})]}):Object(r.jsx)("div",{className:"alert alert-danger",role:"alert",children:"Sorry, a webbrowser that supports the Web Bluetooth API is required. Right now, recent Chrome-based webbrowsers are the only ones that do."});case"connecting":return Object(r.jsx)(ft,{children:"Connecting to Mi Smart Magic Cube..."});case"solving":return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(ut,{state:this.state.facelets}),Object(r.jsx)(bt,{cube_state:this.state.facelets})]});case"displaying_next_rotation":return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(ut,{state:this.state.facelets,rotation:this.state.rotations[0]}),Object(r.jsx)(bt,{cube_state:this.state.facelets})]});case"solved":return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(ut,{state:this.state.facelets}),Object(r.jsx)(bt,{cube_state:this.state.facelets})]});default:throw new Error("Invalid state ID ".concat(this.state.id))}}}]),n}(i.a.Component),pt=function(){return Object(r.jsx)("div",{className:"App container-fluid",children:Object(r.jsx)(vt,{})})},jt=function(t){t&&t instanceof Function&&n.e(3).then(n.bind(null,32)).then((function(e){var n=e.getCLS,r=e.getFID,a=e.getFCP,i=e.getLCP,c=e.getTTFB;n(t),r(t),a(t),i(t),c(t)}))};o.a.render(Object(r.jsx)(i.a.StrictMode,{children:Object(r.jsx)(pt,{})}),document.getElementById("root")),jt()}},[[31,1,2]]]);
//# sourceMappingURL=main.9ab1097f.chunk.js.map